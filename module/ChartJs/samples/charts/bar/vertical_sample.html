<!doctype html>
<html>

<head>
	<title>Bar Chart</title>
	<script src="/module/ChartJs/Chart.js"></script>
	<script src="/module/ChartJs/samples/utils.js"></script>
	<style>
	canvas {
		-moz-user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}
	</style>
</head>

<body>
	<div id="container" style="width:1000px;height:700px;">
		<canvas id="canvas"></canvas>
	</div>

	<script>
		var color = Chart.helpers.color;

		var barChartData = {
			labels: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],
			datasets: [{
				backgroundColor: [
					color(window.chartColors.orange).alpha(0.5).rgbString(),
					color(window.chartColors.darksalmon).alpha(0.5).rgbString(),
					color(window.chartColors.red).alpha(0.5).rgbString(),
					color(window.chartColors.lightgreen).alpha(0.5).rgbString(),
					color(window.chartColors.greenyellow).alpha(0.5).rgbString(),
					color(window.chartColors.mediumspringgreen).alpha(0.5).rgbString(),
					color(window.chartColors.lightblue).alpha(0.5).rgbString(),
					color(window.chartColors.lightskyblue).alpha(0.5).rgbString(),
					color(window.chartColors.blue).alpha(0.5).rgbString(),
					color(window.chartColors.thistle).alpha(0.5).rgbString(),
					color(window.chartColors.violet).alpha(0.5).rgbString(),
					color(window.chartColors.slateblue).alpha(0.5).rgbString()
				],
				borderColor: [
					window.chartColors.orange,
					window.chartColors.darksalmon,
					window.chartColors.red,
					window.chartColors.lightgreen,
					window.chartColors.greenyellow,
					window.chartColors.mediumspringgreen,
					window.chartColors.lightblue,
					window.chartColors.lightskyblue,
					window.chartColors.blue,
					window.chartColors.thistle,
					window.chartColors.violet,
					window.chartColors.slateblue,
				],
				borderWidth: 1,
				data: [
					randomScalingFactor(),
					randomScalingFactor(),
					randomScalingFactor(),
					randomScalingFactor(),
					randomScalingFactor(),
					randomScalingFactor(),
					randomScalingFactor(),
					randomScalingFactor(),
					randomScalingFactor(),
					randomScalingFactor(),
					randomScalingFactor(),
					randomScalingFactor()
				]
			}]

		};

		Chart.plugins.register({
			afterDatasetsDraw: function(chart) {
				var ctx = chart.ctx;
				
				chart.data.datasets.forEach(function(dataset, i) {
					var meta = chart.getDatasetMeta(i);
					if (!meta.hidden) {
						meta.data.forEach(function(element, index) {
							// Draw the text in black, with the specified font
							ctx.fillStyle = 'rgb(0, 0, 0)';
							var fontSize = 16;
							var fontStyle = 'normal';
							var fontFamily = 'Helvetica Neue';
							ctx.font = Chart.helpers.fontString(fontSize, fontStyle, fontFamily);

							// Just naively convert to string for now
							var dataString = dataset.data[index].toString();
							
							// Make sure alignment settings are correct
							ctx.textAlign = 'center';
							ctx.textBaseline = 'middle';
							
							var padding = 5;
							var position = element.tooltipPosition();
							ctx.fillText(dataString, position.x, position.y - (fontSize / 2) - padding);
						});
					}
				});
			}
		});


		window.onload = function() {
			var ctx = document.getElementById('canvas').getContext('2d');
			ctx.canvas.height = '300px';
			window.myBar = new Chart(ctx, {
				type: 'bar',
				data: barChartData,
				options: {
					responsive: true,
					legend: {
						display: false,
						position: 'top',
					},
					title: {
						display: true,
						fontSize:'16',
						padding:'16',
						text: 'Chart.js Bar Chart'
					},
					tooltips:{ 
						enabled: false,
						displayColors: false 
					},
					scales: { 
						yAxes: [{ 
							ticks: { 
								beginAtZero: true,
								callback: function(value) {if (value % 1 === 0) {return value;}}
							} 
						}] 
					} 
				}
			});

		};

	</script>
</body>

</html>
